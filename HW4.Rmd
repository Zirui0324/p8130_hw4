---
title: "HW4"
output: html_document
date: "2022-11-12"
---

```{r message=FALSE}
library(tidyverse)
library(BSDA)
library(readxl)
library(readr)

knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE)
```

## Problem1

```{r}
blood_data = c(125, 123, 117, 123, 115, 112, 128, 118, 124, 111, 116, 109, 125, 120, 113, 123, 112, 118, 121, 118, 122, 115, 105, 118, 131)
blood_test_data = blood_data - 120
SIGN.test(blood_test_data, alternative = "less", conf.level = 0.95)
```

* a)
  According to the sign-test above, we can see that the test statistic is **what?** with p-value **0.2706**. Thus we fail to reject the null hypothesis under a 0.05 significant level and claim that the median blood sugar readings was 120 in the population from which the 25 patients were selected.
 
```{r}
wilcox.test(blood_test_data, alternative = "less", conf.level = 0.95)
``` 
* b)
  According to Wilcoxon signed-rank test, we can see that the test statistic is **what?** with p-value **0.1447**. Thus we fail to reject the null hypothesis under a 0.05 significant level and claim that the median blood sugar readings was 120 in the population from which the 25 patients were selected.
  
  
## Problem 2
```{r}
brain_data = 
  read_xlsx("./Brain.xlsx")[-c(1),] %>% 
  janitor::clean_names()

brain_fit = 
  lm(glia_neuron_ratio ~ ln_brain_mass, data = brain_data) 

brain_fit %>% 
  broom::tidy()
```
* a) 
  The linear model for the nonhuman data using ln (brain mass) as the predictor is : **y = 0.181x + 0.164**.

```{r}
y_0 = 0.181*7.22 + 0.164
```

* b)
  The predicted glia-neuron ratio for humans is **`r y_0`**.

* c)
  

* d)


* e)


## Problem 3
```{r}
heart_data = 
  read.csv("./HeartDisease.csv") %>% 
  mutate(
    gender = as.factor(gender),
    gender = recode(gender, "0" = "otherwise", "1" = "male")
         )
  
```

* a)
  The main predictor of this dataset is **total cost**, The main outcome is **number of emergency room visits**.
  Other important covariates: **age, gender, complications, duration**.
  Here are some descriptions of the important variables:
  
```{r}
summary(heart_data$totalcost)
summary(heart_data$ERvisits)
summary(heart_data$age)
summary(heart_data$complications)
summary(heart_data$duration)

gender_sum = 
  heart_data %>% 
  group_by(gender) %>% 
  summarise(count = n())

  barplot(height = gender_sum$count,
          names = gender_sum$gender)
```


* b)
  Investigate the shape of the distribution for variable totalcost and try different transformations, if needed.
  
```{r}
hist(heart_data$totalcost, xlab = "Total Cost", breaks = 100)
hist((heart_data$totalcost)^2, xlab = "ln(Total Cost)", breaks = 100)
hist((heart_data$totalcost)^(-1), xlab = "ln(Total Cost)", breaks = 100)
hist(log(heart_data$totalcost), xlab = "ln(Total Cost)", breaks = 100)
```

It seems that the plot best fits normality after ln transformation.

```{r}
heart_data2 = 
  heart_data %>% 
  filter(totalcost > 0) 

shapiro.test(log(heart_data2$totalcost))
```
  
The Shapiro Test shows that total cost data dosen't follow normal distribution after ln transformation.

* c)


* d)


* e)


* f)



